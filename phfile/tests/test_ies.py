#!/usr/bin/python3
# -*- coding: utf-8 -*-
"""Tests for IES class.

Copyright (c) 2018 Przemysław Kaliś przemek.kalis@gmail.com

"""


import unittest


from .test_data import ies_document_dict
from .. import IES
from .. import PhotometryValidationError


class TestIES(unittest.TestCase):
    """."""

    def setUp(self):
        """."""
        self._ies_obj = IES()
        self._ies_obj._validator.validate(ies_document_dict, update=True)

    def test_text(self):
        """."""
        ies_input = {
            'header': 'IESNA:LM-63-2002',
            'test': '2016-09-28 /JW',
            'testlab': 'AQLAB',
            'issuedate': '2016-09-28',
            'manufac': 'AQForm - Aquaform Inc.,',
            'lumcat': '10312-L927-S1',
            'luminaire': '2000 P20 LED L927 15D track',
            'lampcat':  '---',
            'lamp': 'L927',
            'number_of_lamps': 1,
            'lumens_per_lamp': 1053,
            'candela_multiplier': 1.0,
            'number_of_vertical_angles': 91,
            'number_of_horizontal_angles': 1,
            'photometric_type': 1,
            'units_type': 2,
            'width': -0.07,
            'length': -0.07,
            'height': 0.0,
            'ballast_factor': 1.0,
            'future_use': 1,
            'input_watts': 12.5,
            'vertical_angles': [0.0, 2.0, 4.0, 6.0, 8.0, 10.0, 12.0, 14.0,
                                16.0, 18.0, 20.0, 22.0, 24.0, 26.0, 28.0, 30.0,
                                32.0, 34.0, 36.0, 38.0, 40.0, 42.0, 44.0, 46.0,
                                48.0, 50.0, 52.0, 54.0, 56.0, 58.0, 60.0, 62.0,
                                64.0, 66.0, 68.0, 70.0, 72.0, 74.0, 76.0, 78.0,
                                80.0, 82.0, 84.0, 86.0, 88.0, 90.0, 92.0, 94.0,
                                96.0, 98.0, 100.0, 102.0, 104.0, 106.0, 108.0,
                                110.0, 112.0, 114.0, 116.0, 118.0, 120.0,
                                122.0, 124.0, 126.0, 128.0, 130.0, 132.0,
                                134.0, 136.0, 138.0, 140.0, 142.0, 144.0,
                                146.0, 148.0, 150.0, 152.0, 154.0, 156.0,
                                158.0, 160.0, 162.0, 164.0, 166.0, 168.0,
                                170.0, 172.0, 174.0, 176.0, 178.0, 180.0],
            'horizontal_angles': [0.0],
            'candela_values': [6998.27, 6685.65, 5767.93, 4253.29, 3083.65,
                               2209.96, 1512.62, 1042.1, 752.032, 582.694,
                               490.519, 431.74, 392.66, 366.581, 348.293,
                               333.496, 317.339, 277.741, 215.423, 136.542,
                               74.2517, 20.0355, 8.74346, 7.26298, 6.66608,
                               4.72025, 5.07564, 5.01085, 3.95645, 4.14691,
                               3.60695, 3.41256, 4.32951, 2.7862, 2.47597,
                               1.80642, 3.13178, 2.59378, 2.55844, 2.10487,
                               1.56687, 2.33853, 2.0008, 2.69785, 4.02714,
                               2.84118, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                               0.0, 0.0]
        }
        result = (
            'IESNA:LM-63-2002\n'
            '[TEST] 2016-09-28 /JW\n'
            '[TESTLAB] AQLAB\n'
            '[ISSUEDATE] 2016-09-28\n'
            '[MANUFAC] AQForm - Aquaform Inc.,\n'
            '[LUMCAT] 10312-L927-S1\n'
            '[LUMINAIRE] 2000 P20 LED L927 15D track\n'
            '[LAMPCAT] ---\n'
            '[LAMP] L927\n'
            'TILT=NONE\n'
            '1 1053 1.0 91 1 1 2 -0.07 -0.07 0.0\n'
            '1.0 1 12.5\n'
            '0.0 2.0 4.0 6.0 8.0 10.0 12.0 14.0 16.0 18.0 20.0 22.0 24.0 26.0'
            ' 28.0 30.0 32.0 34.0 36.0 38.0 40.0 42.0 44.0 46.0 48.0 50.0 52.0'
            ' 54.0 56.0 58.0 60.0 62.0 64.0 66.0 68.0 70.0 72.0 74.0 76.0 78.0'
            ' 80.0 82.0 84.0 86.0 88.0 90.0 92.0 94.0 96.0 98.0 100.0 102.0'
            ' 104.0 106.0 108.0 110.0 112.0 114.0 116.0 118.0 120.0 122.0'
            ' 124.0 126.0 128.0 130.0 132.0 134.0 136.0 138.0 140.0 142.0'
            ' 144.0 146.0 148.0 150.0 152.0 154.0 156.0 158.0 160.0 162.0'
            ' 164.0 166.0 168.0 170.0 172.0 174.0 176.0 178.0 180.0\n'
            '0.0\n'
            '6998.27 6685.65 5767.93 4253.29 3083.65 2209.96 1512.62 1042.1'
            ' 752.032 582.694 490.519 431.74 392.66 366.581 348.293 333.496'
            ' 317.339 277.741 215.423 136.542 74.2517 20.0355 8.74346 7.26298'
            ' 6.66608 4.72025 5.07564 5.01085 3.95645 4.14691 3.60695 3.41256'
            ' 4.32951 2.7862 2.47597 1.80642 3.13178 2.59378 2.55844 2.10487'
            ' 1.56687 2.33853 2.0008 2.69785 4.02714 2.84118 0.0 0.0 0.0 0.0'
            ' 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0'
            ' 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0'
            ' 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0\n'
        )
        self.assertRaises(PhotometryValidationError,
                          lambda: self._ies_obj.text)
        self._ies_obj.set(**ies_input)
        self.assertEqual(self._ies_obj.text, result.strip())
